import pandas as pd

def indicator1(df, timeperiod):
    ma = df['close'].rolling(window=timeperiod).mean()
    return pd.DataFrame({'timestamp': df['timestamp'], 'indicator': ma})
# create a sample DataFrame
data = {
    'timestamp': pd.date_range(start='2022-01-01', end='2022-01-31', freq='D'),
    'open': [100, 101, 105, 107, 106, 105, 107, 109, 110, 111, 110, 109, 111, 113, 114, 115, 116, 115, 114, 113, 115, 117, 118, 119, 118, 116, 115, 116, 117, 115],
    'high': [105, 107, 109, 110, 108, 107, 110, 111, 113, 114, 113, 111, 114, 115, 116, 118, 118, 118, 116, 115, 118, 119, 121, 120, 119, 118, 117, 118, 119, 116],
    'low': [99, 99, 103, 105, 105, 103, 105, 106, 108, 109, 108, 107, 108, 110, 111, 113, 114, 114, 111, 110, 112, 113, 116, 117, 118, 115, 114, 113, 115, 114],
    'close': [102, 105, 107, 107, 107, 105, 107, 110, 111, 110, 109, 111, 113, 114, 115, 117, 116, 117, 115, 113, 116, 118, 120, 120, 119, 116, 115, 116, 118, 115],
    'volume': [100000, 120000, 130000, 140000, 150000, 160000, 170000, 180000, 190000, 200000, 190000, 180000, 170000, 160000, 150000, 140000, 130000, 120000, 110000, 100000, 110000, 120000, 130000, 140000, 150000, 160000, 170000, 180000, 190000, 200000]
}
df = pd.DataFrame(data)

# compute moving average with timeperiod=5
ma = indicator1(df, 5)
print(ma)
